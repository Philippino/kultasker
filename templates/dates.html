{% extends 'base.html' %}

{% block title %} Даты обходов {% endblock %}

{% block chapter %}
{% endblock%}

{% block content %}
<body>
<ol class="breadcrumb">
  	<li><a href='/checks/'>Обходы</a></li>
  	<li class='active'>{{ check }}</li>
</ol>
<!-- кнопка нового обхода по выбранному шаблону -->
<p><button class="btn btn-primary"  data-toggle="modal" data-target="#myModal" onclick='show_date();'><strong>Обойти</strong></button>
<a class="btn btn-default" href = '/checks/{{ check.id }}/tasks/'>Список заданий</a></p>
<form name = 'Form1' method = 'GET' target ='_top'>
	{% csrf_token %}
	<table class = 'table table-hover'>
		<tr>
			<td>Дата</td>
			<td>Статус</td>
		</tr>
		<!-- даты обходов -->
		{% for date in dates %}
			<tr>
				<td>
					<button type="button" class="btn btn-link" onclick="location.href='/checks/{{ date.check_id }}/{{ date.id }}/results/'">
						{{ date.date|date:" H:i d-M-Y" }}
					</button>
					</td>
				<td>
					{% if date.status == True %}
							<span class="glyphicon glyphicon-ok"></span>
						{% else %}
							<span class="glyphicon glyphicon-remove"></span>
					{% endif %}
				</td>
			</tr>		
		{% endfor %}
	</table>
	
</form>
<!-- Новый дата обхода -->
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
 		<div class="modal-dialog">
    		<div class="modal-content">
    			<form id='new_check_form' action='' method='POST'>{% csrf_token %}
      			<div class="modal-header">
        			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        			<h4 class="modal-title" id="myModalLabel">Новый обход</h4>
      			</div>
      			<div class="modal-body">
      				Вы хотите создать новый обход c датой
      				<script>     				
      				var date = new Date();
      				var h = date.getHours();
					var m = date.getMinutes();
      				var d = date.getDate();
					var mn = date.getMonth();
					var y = date.getFullYear();
      				document.write('<a>'+h+':'+m+' '+d+'-'+mn+'-'+y+'</a>')
      				</script>
					Продолжить? 
      			</div>
      			<div class="modal-footer">
      				<input type= 'submit' class='btn btn-primary' value = 'Создать'>
        			<button type="button" class="btn btn-default" data-dismiss="modal">Отмена</button>
      			</div>		
    			</form>
    		</div>
  		</div>
	</div>
</body>

{% endblock %}