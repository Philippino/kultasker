{% extends 'base.html' %}

{% block title %} Обходы {% endblock %}

{% block chapter %}
{% endblock %}

{% block content %}
<body>
<ol class="breadcrumb">
  <li class='active'>Обходы</li>
</ol>
<!-- форма вывода таблицы шаблонов обходов -->
<form name = 'form_checks' method = 'GET' target ='_top'>{% csrf_token %} 
	<!-- кнопка добавления нового шаблона обхода -->
	<p><a onclick="location.href='/checks/new/'" class="btn btn-primary"><strong>Новый обход</strong></a></p>
	<!--таблица шаблонов обходов-->
	<table class = 'table table-bordered'>
		<tr>
			<td>Обход</td>
			<td>Последний обход</td>
		</tr>
		<!-- Вывод элементов таблицы check-->
		{% for check in checks %}
		<tr>
			<td>
				<!-- название шаблона обхода--><!-- ссылка на даты, ссылающиеся на обход-->
				<a type="button" class="btn btn-link" href='/checks/{{ check.id }}/dates'>{{ check.name }}</a>
			</td> 
			<!-- кнопка действий -->
			<td>
			{% for date in last_dates %}
				{% if date.check_id == check.id %}
					<a type="button" class="btn btn-link" href='/checks/{{ check.id }}/{{ date.id }}/results/'>
						{{ date.date }}
					</a>
						{% if date.status == True %}
							<span class="glyphicon glyphicon-ok"></span>
						{% else %}
							<span class="glyphicon glyphicon-remove"></span>
						{% endif %}
				{% endif %}
			{% endfor %}	
			</td>
		</tr>		
		{% endfor %}
	</table>
</form>

<script language= 'text/javascript'>
	<!-- скрипт обращения к датам обхода -->
	function view_dates()
	{	
		document.form_checks.action = '/checks/{{ check.id }}/dates';
		document.form_checks.submit();
		return true;
	}
</script>
</body>
{% endblock %}